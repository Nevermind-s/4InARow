#!/usr/bin/env python2
import cv2
import numpy as np
import matplotlib.pyplot as plt


class gameScheme:
    def __init__(self):
        self.img = cv2.imread('img/game1.png', cv2.IMREAD_COLOR)
        self.pos = [(128.71774193548387, 93.387096774193651), (308.04032258064512, 93.387096774193651), (505.82258064516134, 82.838709677419502), (671.95967741935488, 93.387096774193651), (851.2822580645161, 103.9354838709678), (1017.4193548387098, 103.9354838709678), (1183.5564516129032, 96.024193548387075), (126.08064516129033, 251.61290322580646), (292.2177419354839, 246.33870967741939), (474.17741935483866, 246.33870967741939), (640.31451612903231, 254.25), (853.91935483870975, 259.52419354838719), (1017.4193548387098, 256.88709677419365), (1196.741935483871, 254.25), (99.709677419354847, 420.38709677419365), (308.04032258064512, 412.47580645161293), (476.8145161290322, 409.83870967741939), (674.59677419354841, 409.83870967741939), (856.55645161290317, 420.38709677419365), (1030.6048387096773, 423.02419354838719), (1188.8306451612902, 415.11290322580646), (94.435483870967772, 589.16129032258073), (265.84677419354841, 578.61290322580646), (490.0, 581.25000000000011), (674.59677419354841, 581.25000000000011), (853.91935483870975, 581.25000000000011), (1009.508064516129, 573.33870967741939), (1204.6532258064517, 575.97580645161293), (89.161290322580641, 731.56451612903231), (279.0322580645161, 763.20967741935488), (484.72580645161293, 750.02419354838719), (661.41129032258061, 747.38709677419365), (827.54838709677415, 734.20161290322585), (1022.6935483870968, 744.75), (1204.6532258064517, 736.8387096774195), (102.34677419354838, 924.07258064516134), (302.76612903225805, 921.4354838709678), (487.36290322580646, 926.70967741935488), (682.50806451612902, 913.52419354838719), (867.10483870967732, 926.70967741935488), (1012.1451612903227, 931.98387096774195), (1191.4677419354839, 910.88709677419365)]

        self.stateOfGame = []
        #self.printd()
        self.getRGB()
        # print(np.reshape(self.stateOfGame, (6,7)))

    def getRGB(self):
        for i, j in enumerate(self.pos):
            color = self.img[j[1], j[0]]

            if color[2] > 190 and color[1] < 162:
                print (i+1, " RED", color)
                self.stateOfGame.append(1)
            elif color[1] > 140 and color[2] > 140:
                print (i+1, " YELLOW", color)
                self.stateOfGame.append(2)
            else:
                print(i+1, " EMPTY", color)
                self.stateOfGame.append(0)

    def getState(self):
        return np.reshape(self.stateOfGame, (6, 7))

    def printd(self):
        im = plt.imread('img/game1.png')
        implot = plt.imshow(im)
        x = plt.ginput(42)
        print(x)
        plt.show()


if __name__ == '__main__':
    a = gameScheme()
    cv2.destroyAllWindows()
